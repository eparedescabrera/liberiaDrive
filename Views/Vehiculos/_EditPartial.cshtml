@model LiberiaDriveMVC.Models.Vehiculo
@{
    Layout = null;
}

<h5 class="fw-bold text-warning mb-3">
    <i class="bi bi-pencil-square"></i> Editar Veh√≠culo
</h5>
<hr />

<form id="formEditarVehiculo" method="post">
    <input type="hidden" asp-for="IdVehiculo" />

    <!-- üîπ Marca -->
    <div class="mb-3">
        <label asp-for="Marca" class="form-label">Marca</label>
        <input asp-for="Marca" class="form-control" placeholder="Ej: Toyota" required />
        <span asp-validation-for="Marca" class="text-danger"></span>
    </div>

    <!-- üîπ Modelo -->
    <div class="mb-3">
        <label asp-for="Modelo" class="form-label">Modelo</label>
        <input asp-for="Modelo" class="form-control" placeholder="Ej: Corolla" required />
        <span asp-validation-for="Modelo" class="text-danger"></span>
    </div>

    <!-- üîπ Transmisi√≥n -->
    <div class="mb-3">
        <label asp-for="Transmision" class="form-label">Transmisi√≥n</label>
        <select asp-for="Transmision" class="form-select" required>
            <option value="">-- Seleccione tipo de transmisi√≥n --</option>
            <option value="Autom√°tica" selected="@(Model.Transmision == "Autom√°tica" ? "selected" : null)">Autom√°tica</option>
            <option value="Manual" selected="@(Model.Transmision == "Manual" ? "selected" : null)">Manual</option>
        </select>
        <span asp-validation-for="Transmision" class="text-danger"></span>
    </div>

    <!-- üîπ Estado -->
    <div class="form-check mb-3">
        <input type="checkbox" name="Estado" class="form-check-input" value="true"
               @(Model.Estado ? "checked" : "") />
        <input type="hidden" name="Estado" value="false" />
        <label class="form-check-label">Activo</label>
    </div>

    <!-- üîπ Botones -->
    <div class="text-end">
        <button type="submit" class="btn btn-warning px-4 text-white">
            <i class="bi bi-save"></i> Actualizar
        </button>
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
            <i class="bi bi-x-circle"></i> Cancelar
        </button>
    </div>
</form>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        // ‚úÖ Env√≠o del formulario con AJAX + SweetAlert
        $(document).off("submit", "#formEditarVehiculo").on("submit", "#formEditarVehiculo", function (e) {
            e.preventDefault();

            const form = $(this);
            const data = form.serialize();

            $.ajax({
                url: "/Vehiculos/Edit",
                type: "POST",
                data: data,
                success: function (resp) {
                    if (resp.success) {
                        Swal.fire({
                            icon: "success",
                            title: "Veh√≠culo actualizado",
                            text: "Los cambios fueron guardados correctamente.",
                            timer: 1800,
                            showConfirmButton: false
                        });
                        $("#modalVehiculo").modal("hide");
                        setTimeout(() => location.reload(), 1500);
                    } else {
                        Swal.fire("Error", resp.message, "error");
                    }
                },
                error: function () {
                    Swal.fire("Error", "No se pudo actualizar el veh√≠culo.", "error");
                }
            });
        });
    </script>
}
